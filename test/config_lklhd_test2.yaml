seed: 42
esass_image: DR1
telescope:
  tm_ids : [2]
  rebin: 80 # set by the consortium
  fov: 512
  pattern: 15
  detmap: True
  exp_cut: 500
  badpix_correction: True
  effective_area_correction: True

psf:
 method: 'LIN'
 energy: ['0277', '1486', '3000'] #FIXME: check whether to use '0930'
  # LIN config
 npatch: 8
 margfrac: 0.062
 want_cut: False

  # MSC config
#  base: [3,3]
#  min_baseshape: [8,8]
#  linlevel: [100,100]
#  kernel_sizes: [[3,3],]
#  keep_overlap: [[True,True],]
#  local_kernel: [True,True]

  # config for homogeneous gauss psf
#  gauss_var: 5

plotting:
  enabled: True
  slice: Null
  dpi: 800

grid:
  sdim: 128
  edim: 3 # FIXME: remove this parameter
  s_padding_ratio: 1.1075 # leads to a 1134, which is a "good size" padded space
  e_padding_ratio: 1.
  energy_bin:
    e_min:
    - 0.2
    - 1.0
    - 2.0
    e_max:
    - 1.0
    - 2.0
    - 4.5
    e_ref:
    - 2


files:
  obs_path: '../data/LMC_SN1987A-128/'
  data_dict: 'data.pkl'
  processed_obs_folder: 'processed'  # only needed for actual data
  input: 'pm00_700161_020_EventList_c001.fits'
  output: 'pm00_700161_020_data.fits'
  exposure: 'pm00_700161_020_expmap.fits'
  calibration_path : '../data/'
  psf_path : '../data/psf_info/'
  effective_area_filename_suffix: '_arf_filter_000101v02.fits'
  psf_base_filename: '2dpsf_190219v05.fits'
  res_dir: 'results/lklhdtest_2'
# If mock:
  mock_gen_config: 'mock_config.yaml'
  pos_dict: 'pos.pkl'

priors:
  point_sources:
    spatial:
      alpha: 1.5372972659780446
      key: points
      q: 1.1171446438749864e-09
#    dev_wp:
#      name: points_dev_wp
#      sigma:
#      - 0.01
#      - 0.02
#      x0: 0
    plaw:
      mean: -0.3
      name: points_plaw_
      std: 0.1

#    dev_corr:
#      fluctuations:
#        fluctuations:
#          - 1.0
#          - 5.0e-3
#        loglogavgslope:
#          - -3
#          - 1.0e-2
#        flexibility:
#          - 2.0
#          - 5.0e-1
#        asperity:
#        non_parametric_kind: "power"
#        # harmonic_type: "Fourier"
#      prefix: points_dev
#      offset:
#        offset_mean: 0.0
#        offset_std:
#          - 1.0e-3
#          - 1.0e-4
  diffuse:
    spatial:
      fluctuations:
        asperity: null
        flexibility:
        - 0.4
        - 0.01
        fluctuations:
        - 0.5
        - 0.01
        loglogavgslope:
        - -4.0
        - 0.1
        non_parametric_kind: power
      offset:
        offset_mean: -20.3
        offset_std:
        - 0.3
        - 0.05
      prefix: diffuse_spatial_
    plaw:
      fluctuations:
        asperity: null
        flexibility:
        - 0.5
        - 0.05
        fluctuations:
        - 0.5
        - 0.1
        loglogavgslope:
        - -5.0
        - 0.01
        non_parametric_kind: power
      offset:
        offset_mean: -1.3
        offset_std:
        - 0.1
        - 0.01
      prefix: diffuse_plaw_

minimization:
    resume: False
    n_total_iterations: 15
    delta:
      switches:
      values: 1.e-5

    samples:
      switches: [0, 10]
      n_samples: 8
      mode: [linear_resample, nonlinear_resample]
      # Possible modes:
      # - "linear_sample",
      # - "linear_resample",
      # - "nonlinear_sample",
      # - "nonlinear_resample",
      # - "nonlinear_update",

      # LIN SAMPLING
      # lin_absdelta: [Null, 1.e-4] # if set, delta is ignored
      lin_maxiter: 100

      # NONLIN SAMPLING
      # nonlin_xtol: [Null, 0.1] # if set, delta is ignored
      nonlin_maxiter: 3
      # nonlin_cg_atol: [0.1, 0.01]
      # nonlin_cg_maxiter: [20, 30]

    kl_minimization:
      switches:
      # kl_absdelta: [Null, 1.e-6] # if set, delta is ignored
      kl_maxiter: 25