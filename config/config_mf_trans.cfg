[sf_sky]
npix_s = int :: 1024
npix_e = int :: 2
fov = float ::  17.0
e_lim min = float :: 0.5
e_lim max = float :: 7.0
spatial diffuse asperity mean = float :: 0.1
spatial diffuse asperity std = float :: 0.5
spatial diffuse flexibility mean = float :: 2.0
spatial diffuse flexibility std = float :: 2.0
spatial diffuse fluctuations mean = float :: 1.0
spatial diffuse fluctuations std = float :: 1.0
spatial diffuse loglogavgslope mean = float :: -3.0
spatial diffuse loglogavgslope std = float :: 1.5
diffuse offset_mean = float :: 0.0
diffuse offset_std mean = float :: 0.3
diffuse offset_std std = float :: 0.05
points brightness alpha = float :: 3.0
points brightness q = float :: 0.7

[mf_sky]
base = sf_sky
npix_e = int :: 3
energy diffuse asperity mean = float :: 0.1
energy diffuse asperity std = float :: 0.5
energy diffuse flexibility mean = float :: 0.3
energy diffuse flexibility std = float :: 0.05
energy diffuse fluctuations mean = float :: 0.5
energy diffuse fluctuations std = float :: 0.5
energy diffuse loglogavgslope mean = float :: -2.5
energy diffuse loglogavgslope std = float :: 0.5
spatial points loglinear slope mean = float :: -2.43
spatial points loglinear slope std = float :: 0.25
energy points asperity mean = float :: 0.01
energy points asperity std = float :: 0.01
energy points flexibility mean = float :: 0.01
energy points flexibility std = float :: 0.01
energy points fluctuations mean = float :: 1.0
energy points fluctuations std = float :: 0.25
energy points loglogavgslope mean = float :: -2.00
energy points loglogavgslope std = float :: 0.25
points offset_mean = float :: 0.0
points offset_std mean = float :: 0.001
points offset_std std = float :: 0.00000001

[sf_lh]
sky = *sf_sky
energy_bins = [0]
dataset_list =  df_14423_observation.npy
                df_9107_observation.npy
                df_13738_observation.npy
                df_13737_observation.npy
                df_13739_observation.npy
                df_13740_observation.npy
                df_13741_observation.npy
                df_13742_observation.npy
                df_13743_observation.npy
                df_14424_observation.npy
                df_14435_observation.npy

[mf_lh]
base = sf_lh
sky = *mf_sky
energy_bins = [0,1,2]

[trans]


[icsamp]
custom function = nifty8.AbsDeltaEnergyController
iteration limit = int :: 100
deltaE = float :: 0.05
name = Sampling(lin)

[icnlsamp]
custom function = nifty8.GradientNormController
iteration limit = int :: 100
name = Sampling(nonlin)

[icmini]
custom function = nifty8.AbsDeltaEnergyController
convergence level = int :: 5
deltaE = float :: 0.5
iteration limit = int :: 5
name = NL


[mini_nlsamp]
custom function = nifty8.NewtonCG
controller = *icnlsamp

[mini0]
custom function = nifty8.NewtonCG
controller = *icmini


[optimization]
output directory = ../mf_rec_1024
random seed = 42
save strategy = last
inspect callback = *callback


[base.optimization]
point estimates = None
constants = None
nonlinear sampling minimizer = *mini_nlsamp
sampling iteration controller = *icsamp

[optimization.0]
base = base.optimization
total iterations = 4
likelihood energy = *mf_lh
transitions = None
n samples = 3
kl minimizer = *mini0

[callback]
export_operator_outputs = {"signal": signal,
                           "point_sources": points,
                           "diffuse": diffuse}
output_directory = ../mf_rec_1024
save_strategy = last
obs_type = CMF
